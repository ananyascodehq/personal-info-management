{% extends 'base.html' %} {% block content %}

<!-- =========================
     HEADER + PRIMARY ACTION
========================= -->
<div class="d-flex justify-content-between align-items-start mb-4">
  <div>
    <h1 class="page-title mb-1">People</h1>
    <p class="page-subtitle mb-0">
      Central directory of personal profiles with linked career and education
      records.
    </p>
  </div>

  <a href="{{ url_for('add_person') }}" class="btn btn-primary">
    + Add Person
  </a>
</div>

<!-- =========================
     SEARCH / UTILITIES
========================= -->
<div class="panel mb-4">
  <form method="GET" action="{{ url_for('index') }}">
    <div class="input-group">
      <span class="input-group-text">üîç</span>
      <input
        type="text"
        name="q"
        class="form-control"
        placeholder="Search by name, email, or phone"
        value="{{ search_query }}"
      />
      {% if search_query %}
      <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
        Clear
      </a>
      {% endif %}
    </div>
  </form>

  {% if search_query %}
  <p class="text-muted mt-2 mb-0">
    Showing results for <strong>‚Äú{{ search_query }}‚Äù</strong>
  </p>
  {% endif %}
</div>

<!-- =========================
     CONTENT
========================= -->
{% if is_empty %}

<!-- üå± EMPTY STATES -->
<div class="empty-state">
  {% if search_query %}
  <h5>No results found</h5>
  <p>
    We couldn‚Äôt find anyone matching
    <strong>‚Äú{{ search_query }}‚Äù</strong>.
  </p>
  <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
    Clear search
  </a>
  {% else %}
  <h5>No people yet</h5>
  <p>
    Start by adding a person to manage profiles, careers, and education
    information in one place.
  </p>
  <a href="{{ url_for('add_person') }}" class="btn btn-primary">
    + Add your first person
  </a>
  {% endif %}
</div>

{% else %}

<!-- =========================
       PEOPLE TABLE
  ========================= -->
<div class="panel">
  <h5 class="mb-3">All People</h5>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Date of Birth</th>
          <th>Gender</th>
          <th>Phone</th>
          <th>Email</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        {% for row in persons %}
        <tr
          class="clickable-row"
          data-href="{{ url_for('person_detail', id=row.person_id) }}"
          onclick="window.location=this.dataset.href"
        >
          <td class="fw-semibold">{{ row.name }}</td>
          <td>{{ row.dob or '-' }}</td>
          <td>{{ row.gender }}</td>
          <td>{{ row.phone }}</td>
          <td>{{ row.email }}</td>

          <!-- ‚ãÆ ACTIONS -->
          <td onclick="event.stopPropagation()">
            <div class="dropdown">
              <button
                class="btn btn-sm btn-light"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                ‚ãÆ
              </button>
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <a
                    class="dropdown-item"
                    href="{{ url_for('update_person', id=row.person_id) }}"
                  >
                    Edit
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <form
                    action="{{ url_for('delete_person', id=row.person_id) }}"
                    method="POST"
                    onsubmit="return confirm('Delete this person? This action cannot be undone.');"
                  >
                    <button type="submit" class="dropdown-item text-danger">
                      Delete
                    </button>
                  </form>
                </li>
              </ul>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endif %} {% endblock %}
